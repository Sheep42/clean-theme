"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sanitizeHtml=sanitizeHtml,exports.DefaultWhitelist=void 0;var uriAttrs=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],ARIA_ATTRIBUTE_PATTERN=/^aria-[\w-]*$/i,DefaultWhitelist={"*":["class","dir","id","lang","role",ARIA_ATTRIBUTE_PATTERN],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]};exports.DefaultWhitelist=DefaultWhitelist;var SAFE_URL_PATTERN=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,DATA_URL_PATTERN=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i;function allowedAttribute(e,t){var r=e.nodeName.toLowerCase();if(-1!==t.indexOf(r))return-1===uriAttrs.indexOf(r)||Boolean(e.nodeValue.match(SAFE_URL_PATTERN)||e.nodeValue.match(DATA_URL_PATTERN));for(var i=t.filter(function(e){return e instanceof RegExp}),a=0,o=i.length;a<o;a++)if(r.match(i[a]))return!0;return!1}function sanitizeHtml(e,t,r){if(0===e.length)return e;if(r&&"function"==typeof r)return r(e);for(var i=(new window.DOMParser).parseFromString(e,"text/html"),a=Object.keys(t),o=[].slice.call(i.body.querySelectorAll("*")),n=function(e,r){var i=o[e],n=i.nodeName.toLowerCase();if(-1===a.indexOf(i.nodeName.toLowerCase()))return i.parentNode.removeChild(i),"continue";var l=[].slice.call(i.attributes),s=[].concat(t["*"]||[],t[n]||[]);l.forEach(function(e){allowedAttribute(e,s)||i.removeAttribute(e.nodeName)})},l=0,s=o.length;l<s;l++)n(l);return i.body.innerHTML}